\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{cmap}

\begin{document}

Задача состояла в том, чтобы быстро обрабатывать запросы двух типов:

1) присвоить всем вершинам на пути из $u$ в $v$ вес $w$

2) найти непустой максимальный подотрезок на пути из $u$ в $v$

Пусть мы построили heavy-light decomposition, заведем для каждого пути из декомпозиции дерево отрезков.
Эта структура данных умеет делать присвоение на отрезке и запрос максимального подотрезка за $O(logN)$
(для этого нужно в каждой вершине хранить наибольший непустой суффикс, префикс, подотрезок, а также сумму
и отложенное присвоение).

Тогда запрос к пути из $u$ в $v$ разбивается на не более чем $O(logN)$ запросов к деревьям отрезков путей
из декомпозиции.
Итого, сложность обработки одного запроса ~--- $O(log^{2}(N))$.


\end{document}
